// template migration file generated by migrate-mongo

const indexName = "uniqueIdIndex";

/**
 * @param {import('mongodb').Db} db
 * @param {import('mongodb').MongoClient} client
 * @returns {Promise<void>}
 */
export const up = async (db, client) => {
  db.collection("annotations2").createIndex({ "@id": 1 }, { name: indexName, unique: true });
  db.collection("annotations3").createIndex({ "id": 1 }, { name: indexName, unique: true });
  db.collection("manifests2").createIndex({ "@id": 1 }, { name: indexName, unique: true });
  db.collection("manifests3").createIndex({ "id": 1 }, { name: indexName, unique: true });
};

/**
 * @param db {import('mongodb').Db}
 * @param client {import('mongodb').MongoClient}
 * @returns {Promise<void>}
 */
export const down = async (db, client) => {
  ["manifests2", "manifests3", "annotations2", "annotations3"].map((collName) =>
    db.collection(collName).dropIndex(indexName)
  );
};

